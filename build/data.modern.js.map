{"version":3,"file":"data.modern.js","sources":["../utils.js","../data.js","../render.js"],"sourcesContent":["// @ts-nocheck\nexport function iter(o, fn) {\n    if (isArray(o)) {\n        for (let i = 0; i < o.length; i++)\n            fn(i, o[i]);\n    }\n    else {\n        for (const i in o)\n            fn(i, o[i]);\n    }\n}\nexport const { isArray } = Array;\nexport const identity = d => d;\nexport const noop = () => { };\nexport const U = undefined;\n","// @ts-nocheck\nexport const value = Symbol('value');\nexport const reactive = Symbol.for('reactive');\nexport const $ = (v) => new ViewProxy(View.value(v)); // as unknown as Data<any>\nexport default $;\nexport const view = Symbol('view');\nimport { iter, isArray, noop } from \"./utils.js\";\nconst isObject = v => v.constructor === Object;\nconst Symbols = { value, view };\nconst str = JSON.stringify;\n$.random = (o) => crypto.randomUUID();\nconst sclone = d => d === undefined ? undefined\n    : d[view] ? d[view].value\n        : structuredClone(d);\nclass Value {\n    constructor() {\n        this.view = new View(this);\n        // this.links = new Map;\n    }\n    update(value, key) {\n        if (value instanceof ViewProxy)\n            throw new Error('cannot set value to another data, use a linked value instead');\n        key.length === 0 ? this.XU0(value) // this.XU0(value)\n            : key.length === 1 ? this.BU1([key[0], value])\n                : this.BU2([key, value]);\n    }\n    insert(value, key, at) {\n        if (value instanceof ViewProxy)\n            throw new Error('cannot set value to another data, use a linked value instead');\n        at = at === undefined ? at : `${at}`;\n        key.length === 0 ? this.BI0([at, value])\n            : this.BI2([key, value, at]);\n    }\n    remove(key) {\n        key.length === 0 ? this.XR0()\n            : key.length === 1 ? this.BR1([key[0]])\n                : this.BR2([key]);\n    }\n    XR0() {\n        if (this.view.value === undefined)\n            return false;\n        const value = this.view.value;\n        this.view.value = undefined;\n        this.view.XR0(value);\n    }\n    BR1A(R1) {\n        const NR1 = [];\n        for (let i = 0; i < R1.length; i++) {\n            const name = R1[i];\n            const value = this.view.value?.[name];\n            this.view.value.splice(name, 1);\n            NR1.push(name);\n            NR1.push(value);\n        }\n        this.view.BR1(NR1);\n    }\n    BR1(R1) {\n        if (isArray(this.view.value))\n            return this.BR1A(R1);\n        const NR1 = [];\n        for (let i = 0; i < R1.length; i++) {\n            const name = R1[i];\n            const value = this.view.value?.[name];\n            if (value === undefined)\n                continue; // return false\n            delete this.view.value[name];\n            NR1.push(name);\n            NR1.push(value);\n        }\n        this.view.BR1(NR1);\n    }\n    BR2(R2) {\n        const NR2 = [];\n        loop1: for (let i = 0; i < R2.length; i++) {\n            const key = R2[i];\n            const [last, ...path] = key.slice().reverse();\n            let vo = this.view.value;\n            if (typeof vo !== 'object')\n                return;\n            while (path.length) {\n                const n = path.pop();\n                if (typeof vo !== 'object')\n                    continue loop1;\n                vo = vo[n];\n            }\n            if (vo[last] === undefined)\n                continue loop1;\n            const value = vo[last];\n            if (isArray(vo)) {\n                vo.splice(last, 1);\n            }\n            else {\n                delete vo[last];\n            }\n            NR2.push(key, value);\n        }\n        this.view.BR2(NR2);\n    }\n    XU0(value) {\n        if (this.view.value === value)\n            return;\n        this.view.value = value; // this.link(value)\n        this.view.XU0();\n    }\n    BU1(U1) {\n        const NU1 = [];\n        const NI0 = [];\n        if (typeof this.view.value !== 'object')\n            this.view.value = {};\n        for (let i = 0; i < U1.length; i++) {\n            const name = U1[i++];\n            const value = U1[i];\n            if (this.view.value?.[name] === value)\n                continue;\n            this.view.value?.[name] === undefined\n                ? NI0.push(name, value)\n                : NU1.push(name, value);\n            this.view.value[name] = value;\n        }\n        // console.log('R :>> ', { NU1, NI0 });\n        this.view.BU1(NU1);\n        this.view.BI0(NI0);\n    }\n    BU2(U2) {\n        if (typeof this.view.value !== 'object')\n            this.view.value = {};\n        for (let i = 0; i < U2.length; i++) {\n            const key = U2[i++];\n            const value = U2[i];\n            const [last, ...path] = key.slice().reverse();\n            let vo = this.view.value;\n            while (path.length) {\n                const n = path.pop();\n                vo = typeof vo[n] === 'object' ? vo[n] : (vo[n] = {});\n            }\n            if (vo[last] === value)\n                continue;\n            vo[last] = value; // this.link(key, value)\n        }\n        this.view.BU2(U2);\n    }\n    BI0(I0) {\n        if (isArray(this.view.value))\n            return this.BI0A(I0);\n        if (typeof this.view.value !== 'object')\n            this.view.value = {};\n        for (let i = 0; i < I0.length; i++) {\n            const at = I0[i++] ??= '' + $.random(this.view.value);\n            const value = I0[i];\n            if (this.view.value?.[at] === value)\n                continue;\n            this.view.value[at] = value; // link\n        }\n        this.view.BI0(I0);\n    }\n    BI0A(I0) {\n        for (let i = 0; i < I0.length; i += 2) {\n            const at = I0[i];\n            const value = I0[i + 1];\n            if (at === undefined)\n                I0[i] = '' + (this.view.value.push(value) - 1);\n            else\n                this.view.value.splice(at, 0, value);\n        }\n        this.view.BI0(I0);\n    }\n    BI2(I2) {\n        if (typeof this.view.value !== 'object')\n            this.view.value = {};\n        for (let i = 0; i < I2.length; i++) {\n            const key = I2[i++];\n            const value = I2[i++];\n            const path = key.slice().reverse();\n            let vo = this.view.value;\n            while (path.length) {\n                const n = path.pop();\n                vo = typeof vo[n] === 'object' ? vo[n] : (vo[n] = {});\n            }\n            if (isArray(vo)) {\n                if (I2[i] === undefined)\n                    I2[i] ??= '' + (vo.push(value) - 1);\n                else\n                    vo.splice(I2[i], 0, value); // vo[at] = this.link([at], value)\n            }\n            else {\n                const at = I2[i] ??= '' + $.random(vo);\n                vo[at] = value; // this.link(nkey, value)\n            }\n        }\n        this.view.BI2(I2);\n    }\n}\nclass Operator extends Value {\n}\nclass View {\n    constructor(res) {\n        this.res = res;\n        this.key = [];\n        this.sinks = new Set;\n        this.views = new Map;\n    }\n    static child(p, name) {\n        const view = new View(p.res);\n        view.p = p;\n        view.key = [...p.key, name];\n        view.name = name;\n        view.XU0(p.value?.[name]);\n        return view;\n    }\n    static value(value) {\n        if (value instanceof ViewProxy) {\n            return new LinkedView(value);\n        }\n        else {\n            const res = new Value;\n            res.XU0(value);\n            return res.view;\n        }\n    }\n    XR0(value) {\n        if (this.p)\n            this.value = undefined;\n        this.each((name, child) => {\n            if (child.value !== value?.[name] || child.value !== undefined)\n                child.XR0(value?.[name]);\n        });\n        this.sink(sink => sink.XR0(value, this));\n    }\n    BR1(R1) {\n        if (!R1.length)\n            return;\n        if (!isArray(this.value)) {\n            for (let i = 0; i < R1.length; i += 2)\n                this.get_named(R1[i])?.XR0(R1[i + 1]);\n        }\n        else if (this.views.size) {\n            let offset = Infinity;\n            for (let i = 0; i < R1.length; i += 2) {\n                if (R1[i] < offset)\n                    offset = R1[i];\n                if (!offset)\n                    break;\n            }\n            this.V1(offset);\n        }\n        // this.sink(sink => sink.BR1(R1, this))\n        for (const x of this.sinks) {\n            const sink = x.deref();\n            if (!sink) {\n                this.sinks.delete(sink);\n                continue;\n            }\n            sink.BR1(R1, this);\n        }\n    }\n    BR2(R2) {\n        for (let i = 0; i < R2.length; i++) {\n            const [name, ...rest] = R2[i++];\n            const value = R2[i];\n            rest.length === 1\n                ? this.get_named(name)?.BR1([rest[0], value])\n                : this.get_named(name)?.BR2([rest, value]);\n        }\n        this.sink(sink => sink.BR2(R2, this));\n    }\n    XU0() {\n        if (this.p)\n            this.value = this.p.value?.[this.name];\n        this.each((name, child) => {\n            if (this.value?.[name] !== undefined)\n                child.XU0();\n            else {\n                if (child.value !== undefined)\n                    child.XR0(child.value);\n            }\n        });\n        this.sink(sink => sink.XU0(this.value, this));\n    }\n    BU1(U1) {\n        if (!U1.length)\n            return;\n        if (this.p)\n            this.value = this.p.value?.[this.name];\n        for (let i = 0; i < U1.length; i++)\n            this.get_named(U1[i++])?.XU0();\n        this.sink(sink => sink.BU1(U1, this));\n    }\n    BU2(U2) {\n        if (this.p)\n            this.value = this.p.value?.[this.name];\n        for (let i = 0; i < U2.length; i++) {\n            const [name, ...rest] = U2[i++];\n            const value = U2[i];\n            rest.length === 1\n                ? this.get_named(name)?.BU1([rest[0], value])\n                : this.get_named(name)?.BU2([rest, value]);\n        }\n        this.sink(sink => sink.BU2(U2, this));\n    }\n    BI0(I0) {\n        if (!I0.length)\n            return;\n        if (this.p)\n            this.value = this.p.value?.[this.name];\n        if (isArray(this.value))\n            return this.BI0A(I0);\n        for (let i = 0; i < I0.length; i++)\n            this.get_named(I0[i++])?.XU0();\n        this.sink(sink => sink.BI0(I0, this));\n    }\n    BI0A(I0) {\n        if (this.views.size) {\n            let offset = Infinity;\n            for (let i = 0; i < I0.length; i += 2) {\n                if (I0[i] < offset)\n                    offset = I0[i];\n            }\n            this.V1(offset);\n        }\n        this.sink(sink => sink.BI0(I0, this));\n    }\n    BI2(I2) {\n        if (this.p)\n            this.value = this.p.value?.[this.name];\n        // console.log({ I2 })\n        for (let i = 0; i < I2.length;) {\n            const [name, ...rest] = I2[i++];\n            const value = I2[i++];\n            const at = I2[i++];\n            // console.log({ name, rest, value, at })\n            rest.length\n                ? this.get_named(name)?.BI2([rest, value, at])\n                : this.get_named(name)?.BI0([at, value]);\n        }\n        this.sink(sink => sink.BI2(I2, this));\n    }\n    V1(offset) {\n        for (let i = offset; i < this.value.length + 1; i++) {\n            const child = this.get_named(`${i}`);\n            if (child && child.value !== this.value[i])\n                child.XU0();\n        }\n    }\n    some_sink(fn) {\n        let n;\n        for (const x of this.sinks) {\n            const sink = x.deref?.();\n            if (!sink) { /* console.log('delete') */\n                this.sinks.delete(sink);\n                continue;\n            }\n            if (n = fn(x))\n                return n;\n        }\n    }\n    sink(fn) {\n        for (const x of this.sinks) {\n            const sink = x.deref?.();\n            if (!sink) { /* console.log('delete') */\n                this.sinks.delete(sink);\n                continue;\n            }\n            fn(sink);\n        }\n    }\n    each(fn) {\n        for (const [name, ref] of this.views) {\n            const res = ref.deref?.();\n            if (!res) {\n                this.views.delete(name);\n                continue;\n            }\n            fn(name, res);\n        }\n    }\n    get_or_create_named(name) {\n        return this.views.get(name)?.deref?.() ?? create(this.views, name, View.child(this, name));\n    }\n    get_named(name) {\n        const res = this.views.get(name)?.deref?.();\n        if (!res)\n            this.views.delete(name);\n        return res;\n    }\n    disconnect(sink) {\n        for (const x of this.sinks) {\n            const s = x.deref?.();\n            if (s === sink) {\n                this.sinks.delete(x);\n                break;\n            }\n            if (!s) {\n                this.sinks.delete(x);\n                continue;\n            }\n        }\n    }\n    connect(sink) {\n        this.sinks.add(new WeakRef(sink));\n    }\n}\nexport class Sink {\n}\nclass LinkedView extends View {\n    constructor(p) {\n        super();\n        this.src = p[Symbols.view];\n        this.update(this.src);\n    }\n    update(value, key = []) {\n        if (key.length) {\n            return this.src.res.update(value, key);\n        }\n        if (value instanceof ViewProxy)\n            value = value[Symbols.view];\n        if (!(value instanceof View))\n            throw new Error('cannot set linked value to non-reactive source');\n        this.src.disconnect(this);\n        this.src = value;\n        this.src.connect(this);\n        this.XU0(this.src.value);\n    }\n    insert(...args) { return this.src.res.insert(...args); }\n    remove(...args) { return this.src.res.remove(...args); }\n    XU0(U0) { this.sink(sink => sink.XU0(U0, this)); }\n    BU1(U1) { this.sink(sink => sink.BU1(U1, this)); }\n    BU2(U2) { this.sink(sink => sink.BU2(U2, this)); }\n    XR0(R0) { this.sink(sink => sink.XR0(R0, this)); }\n    BR1(R1) { this.sink(sink => sink.BR1(R1, this)); }\n    BR2(R2) { this.sink(sink => sink.BR2(R2, this)); }\n    BI0(I0) { this.sink(sink => sink.BI0(I0, this)); }\n    BI2(I2) { this.sink(sink => sink.BI2(I2, this)); }\n    get value() { return this.src.value; }\n    get res() { return this; }\n    set res(v) { }\n}\nfunction iter2(arr, fn) {\n    for (let i = 0; i < arr.length; i++)\n        fn(arr[i++], arr[i]);\n}\nfunction iter3(arr, fn) {\n    for (let i = 0; i < arr.length; i++)\n        fn(arr[i++], arr[i++], arr[i]);\n}\nclass ArrSink {\n    constructor(p, arr) {\n        this.p = p;\n        this.arr = arr;\n        this.update([], p.value);\n    }\n    update = (key, value) => this.arr.push({ type: 'update', key, value: sclone(value) });\n    remove = (key, value) => this.arr.push({ type: 'remove', key, value: sclone(value) });\n    insert = (key, value, at) => this.arr.push({ type: 'insert', key, value: sclone(value), at });\n    XU0(value) { this.update([], value); }\n    BU1(U1) { iter2(U1, (name, value) => this.update([name], value)); }\n    BU2(U2) { iter2(U2, (key, value) => this.update(key, value)); }\n    BI0(I0) { iter2(I0, (at, value) => this.insert([], value, at)); }\n    BI2(I0) { iter3(I0, (key, value, at) => this.insert(key, value, at)); }\n    XR0(value) { this.remove([], value); }\n    BR1(R1) { iter2(R1, (name, value) => this.remove([name], value)); }\n    BR2(R2) { iter2(R2, (key, value) => this.remove(key, value)); }\n    R0(value) { this.arr.push({ type: 'remove', key: [], value: sclone(value) }); }\n    R1(name, value) { this.arr.push({ type: 'remove', key: [name], value: sclone(value) }); }\n    R2(key, value) { this.arr.push({ type: 'remove', key, value: sclone(value) }); }\n    U0(value) { this.arr.push({ type: 'update', key: [], value: sclone(value) }); }\n    U1(name, value) { this.arr.push({ type: 'update', key: [name], value: sclone(value) }); }\n    U2(key, value) { this.arr.push({ type: 'update', key, value: sclone(value) }); }\n    I0(value, at) { this.arr.push({ type: 'insert', value: sclone(value), at }); }\n    I1(name, value, at) { this.arr.push({ type: 'insert', key: [name], value: sclone(value), at }); }\n    I2(key, value, at) { this.arr.push({ type: 'insert', key, value: sclone(value), at }); }\n}\nconst lifetimes = new WeakMap;\nclass PropSink extends Sink {\n    p;\n    obj;\n    prop;\n    constructor(p, obj, prop) {\n        super();\n        this.p = p;\n        this.obj = obj;\n        this.prop = prop;\n        this.obj[prop] = p.value;\n        const refs = lifetimes.get(obj) ?? new Set;\n        refs.add(this);\n        lifetimes.set(obj, refs);\n    }\n    XU0(value) { this.obj[this.prop] = value; }\n    XR0() { this.XU0(this.p.value); }\n    BU1() { this.XU0(this.p.value); }\n    BR1() { this.XU0(this.p.value); }\n    BI0() { this.XU0(this.p.value); }\n    BU2() { this.XU0(this.p.value); }\n    BR2() { this.XU0(this.p.value); }\n    BI2() { this.XU0(this.p.value); }\n}\nclass ViewProxy {\n    view;\n    constructor(view) {\n        this.view = view;\n        return new Proxy(noop, this);\n    }\n    deleteProperty(target, name) {\n        const { res, key } = this.view;\n        const path = name === Symbols.value ? key : [...key, '' + name];\n        res.remove(path);\n        return true;\n    }\n    set(t, name, value) {\n        const { res, key } = this.view;\n        const path = name === Symbols.value ? key : [...key, name];\n        res.update(value, path);\n        return true;\n    }\n    get(t, name) {\n        if (name === Symbol.toPrimitive)\n            return (hint) => hint\n                ? this.view.value?.toString()\n                : +this.view.value;\n        if (name === Symbol.iterator)\n            return this.iterator;\n        if (name === Symbols.reactive)\n            return true;\n        if (name === Symbols.view)\n            return this.view;\n        if (name === Symbols.value)\n            return this.view.value;\n        return new ViewProxy(this.view.get_or_create_named(name));\n    }\n    apply(t, m, args) {\n        const { p, name: type } = this.view;\n        if (!p)\n            throw new Error('cannot invoke a root value!');\n        if (type === 'connect')\n            return connect(p, ...args);\n        const Operator = Operators[type]?.(...args);\n        if (Operator) {\n            let sink = p.some_sink(sink => {\n                if (sink instanceof Operator)\n                    return sink.matches(...args);\n            });\n            if (!sink) {\n                p.sinks.add(new WeakRef(sink = new Operator(p, ...args)));\n            }\n            return new ViewProxy(sink.view);\n        }\n        const [value, at] = args;\n        if (type === 'remove')\n            return this.view.res.remove(p.key);\n        if (type === 'update')\n            return this.view.res.update(value, p.key);\n        if (type === 'insert')\n            return this.view.res.insert(value, p.key, at);\n    }\n    getPrototypeOf(targer) {\n        return ViewProxy.prototype;\n    }\n    *iterator(i = 0) {\n        while (true) {\n            yield this[i++];\n        }\n        // for (const k of Object.keys(this[view].value)) {\n        //   yield this[k]\n        // }\n    }\n}\nclass BetweenValue extends Operator {\n    matches(col, [lo, hi]) {\n        return this.col === col && this.plo === lo && this.phi === hi;\n    }\n    constructor(p, col, arg) {\n        super();\n        this.p = p;\n        this.col = col;\n        this.plo = arg[0];\n        this.phi = arg[1];\n        this.sorted = [];\n        this.find = left(d => { return this.p.value[d][col]; });\n        if (arg instanceof ViewProxy) {\n            arg.connect(this, 'extent');\n        }\n        else {\n            arg[0].connect(this, 'lo');\n            arg[1].connect(this, 'hi');\n        }\n        this.XU0(p.value);\n    }\n    set lo(v) {\n        this.extent = v > this.hi_val\n            ? [this.hi_val, v]\n            : [v, this.hi_val];\n    }\n    set hi(v) {\n        this.extent = v < this.lo_val\n            ? [v, this.lo_val]\n            : [this.lo_val, v];\n    }\n    set extent([a = -Infinity, b = Infinity]) {\n        a = +a;\n        b = +b;\n        const new_lo = a < b ? a : b; // TODO: remove\n        const new_hi = a < b ? b : a; // TODO: remove\n        if (!this.view.value)\n            return [this.lo_val, this.hi_val] = [new_lo, new_hi];\n        if (new_lo === -Infinity && new_hi === Infinity) {\n            this.hi_index = this.lo_index = undefined;\n            [this.lo_val, this.hi_val] = [new_lo, new_hi];\n            return this.view.XU0(this.view.value = this.p.value);\n        }\n        if (new_lo === new_hi) {\n            this.hi_index = this.lo_index = undefined;\n            [this.lo_val, this.hi_val] = [new_lo, new_hi];\n            return this.view.XU0(this.view.value = isArray(this.p.value) ? [] : {});\n        }\n        const I0 = [], R1 = [];\n        this.lo_index ??= this.find(this.sorted, this.lo_val);\n        this.hi_index ??= this.find(this.sorted, this.hi_val);\n        let ti, tv;\n        if (new_hi < this.hi_val) {\n            while ((tv = this.p.value[ti = this.sorted[this.hi_index - 1]]) &&\n                (tv[this.col] > new_hi)) {\n                this.hi_index--;\n                R1.push(ti, tv);\n                this.view.value[ti] = undefined;\n            }\n            if (this.lo_index > this.hi_index)\n                this.lo_index = this.hi_index;\n        }\n        if (new_lo > this.lo_val) {\n            while ((tv = this.p.value[ti = this.sorted[this.lo_index]]) &&\n                (tv[this.col] < new_lo)) {\n                this.lo_index++;\n                R1.push(ti, tv);\n                this.view.value[ti] = undefined;\n            }\n            if (this.hi_index < this.lo_index)\n                this.hi_index = this.lo_index;\n        }\n        if (new_hi > this.hi_val) {\n            while ((tv = this.p.value[ti = this.sorted[this.hi_index]]) &&\n                (tv[this.col] < new_hi)) {\n                this.hi_index++;\n                I0.push(ti, tv);\n                this.view.value[ti] = tv;\n            }\n        }\n        if (new_lo < this.lo_val) {\n            while ((tv = this.p.value[ti = this.sorted[this.lo_index - 1]]) &&\n                (tv[this.col] > new_lo)) {\n                this.lo_index--;\n                I0.push(ti, tv);\n                this.view.value[ti] = tv;\n            }\n        }\n        this.lo_val = new_lo;\n        this.hi_val = new_hi;\n        this.view.BI0(I0);\n        this.view.BR1(R1);\n    }\n    XU0(value) {\n        const { col } = this;\n        this.lo_index = undefined;\n        this.hi_index = undefined;\n        if (typeof value !== 'object')\n            return super.XU0();\n        const new_value = isArray(value) ? [] : {};\n        this.sorted = [];\n        iter(value, (i, v) => {\n            this.sorted.push('' + i);\n            if (v[col] >= this.lo_val && v[col] <= this.hi_val)\n                new_value[i] = value[i];\n        });\n        this.sorted.sort((a, b) => {\n            const va = value[a][col];\n            const vb = value[b][col];\n            return va > vb ? 1\n                : va < vb ? -1\n                    : 0;\n        });\n        super.XU0(new_value);\n    }\n}\nclass ZAValue extends Operator {\n    matches(col, n) { return this.col_name == col && this.n == n; }\n    constructor(p, col, col_name, n) {\n        super();\n        this.p = p;\n        this.n = n;\n        this.col = col;\n        this.col_name = col_name;\n        this.XU0(p.value);\n    }\n    XR0() {\n        this.sorted = [];\n        this.view.XU0(this.view.value = []);\n    }\n    XU0(value) {\n        if (typeof value !== 'object')\n            return this.XR0();\n        this.sorted = Object\n            .keys(value)\n            .sort((a, b) => {\n            const va = this.col(value[a]);\n            const vb = this.col(value[b]);\n            return va > vb ? -1\n                : va < vb ? 1\n                    : 0;\n        });\n        this.view.XU0(this.view.value = this.sorted\n            .slice(0, this.n)\n            .map(i => value[i]));\n    }\n    BR1(R1) {\n        for (let i = 0; i < R1.length; i++) {\n            const oidx = this.get_index(R1[i++]);\n            this.sorted.splice(oidx, 1);\n            if (oidx >= this.n)\n                return;\n            super.BR1A([oidx]);\n            const len = this.view.value.length;\n            if (this.sorted.length > len)\n                super.BI0A([len, this.p.value[this.sorted[len]]]);\n        }\n    }\n    BU1(U1) {\n        for (let i = 0; i < U1.length; i++) {\n            const name = U1[i++];\n            const value = U1[i];\n            const { n, p, sorted } = this;\n            let oidx = this.get_index(name);\n            if (oidx === -1) {\n                this.BI0([name, value]);\n                continue;\n            }\n            let nidx = this.find(this.col(this.p.value[name]));\n            if (oidx === nidx) {\n                super.BU1([oidx, value]);\n                continue;\n            }\n            if (nidx > oidx)\n                nidx--;\n            sorted.splice(oidx, 1);\n            sorted.splice(nidx, 0, name);\n            if (oidx >= n && nidx >= n) { }\n            else if (oidx >= n && nidx < n) {\n                super.BR1A([n - 1]);\n                super.BI0A([nidx, p.value[sorted[nidx]]]);\n            }\n            else if (oidx < n && nidx >= n) {\n                super.BR1A([oidx]);\n                super.BI0A([n - 1, p.value[sorted[n - 1]]]);\n            }\n            else if (oidx < n && nidx < n) {\n                const lo = oidx < nidx ? oidx : nidx;\n                const hi = oidx < nidx ? nidx : oidx;\n                for (let idx = lo; idx <= hi; idx++) {\n                    super.BU1(['' + idx, p.value[sorted[idx]]]);\n                }\n            }\n        }\n    }\n    BI0(I0) {\n        for (let i = 0; i < I0.length; i++) {\n            const at = I0[i++];\n            const value = I0[i];\n            const new_idx = this.find(this.col(this.p.value[at]));\n            this.sorted.splice(new_idx, 0, at);\n            if (new_idx >= this.n)\n                return;\n            if (this.view.value.length === this.n)\n                super.BR1A([this.n - 1]);\n            super.BI0A([new_idx, value]);\n        }\n    }\n    BR2(R2) {\n        for (let i = 0; i < R2.length; i++) {\n            const [name, col, ...rest] = R2[i++];\n            const value = R2[i];\n            if (col === this.col_name) {\n                this.U1(changes, name, this.p.value[name]);\n            }\n            else {\n                const oidx = this.get_index(name);\n                if (oidx < this.n)\n                    this.view.BR2([[`${oidx}`, col, ...rest], value]);\n            }\n        }\n    }\n    BU2(U2) {\n        for (let i = 0; i < U2.length; i++) {\n            const [name, col, ...rest] = U2[i++];\n            const value = U2[i];\n            if (col === this.col_name) {\n                this.BU1([name, this.p.value[name]]);\n            }\n            else {\n                const oidx = this.get_index(name);\n                if (oidx < this.n) {\n                    this.view.BU2([[`${oidx}`, col, ...rest], value]);\n                }\n            }\n        }\n    }\n    BI2(I2) {\n        for (let i = 0; i < I2.length; i++) {\n            const [name, ...rest] = I2[i++];\n            const value = I2[i++];\n            const at = I2[i];\n            if (!this.has(name)) {\n                this.BI0([name, this.p.value[name]]);\n                continue;\n            }\n            // TODO: assuming this type of assert can't change val atm\n            const nidx = this.get_index(name);\n            if (nidx >= this.n)\n                continue;\n            this.view.BI2([[`${nidx}`, ...rest], value, at]);\n        }\n    }\n    get_index(id) {\n        return this.sorted.indexOf(id);\n    }\n    has(id) { return !!~this.get_index(id); }\n}\nZAValue.prototype.find = bisect_right;\nclass ZAColumnValue extends ZAValue {\n    constructor(p, col, n = Infinity) {\n        super(p, d => d[col], col, n);\n    }\n}\nclass ZANumberValue extends ZAValue {\n    constructor(p, n = Infinity) {\n        super(p, d => d, value, n);\n    }\n}\nclass LimitValue extends Operator {\n    constructor(p, n) {\n        super();\n        this.p = p;\n        this.n = n;\n        this.XU0(this.p.value);\n    }\n    XR0() { this.XU0(this.p.value); }\n    BU1(U1) { if (U1[0] < this.last)\n        this.XU0(this.p.value); }\n    BI0(I0) { if (I0[0] < this.last || this.view.value.length < this.n)\n        this.XU0(this.p.value); }\n    BR1(R1) { if (R1[0] < this.last || this.view.value.length < this.n)\n        this.XU0(this.p.value); }\n    // BR2(){ this.XU0(this.p.value) }\n    // BU2(){ this.XU0(this.p.value) }\n    // BI2(){ this.XU0(this.p.value) }\n    XU0(value) {\n        this.view.value = [];\n        this.index = [];\n        if (typeof value === 'object') {\n            if (isArray(value)) {\n                let i = -1;\n                while (i < value.length) {\n                    if (value[++i] !== undefined) {\n                        this.view.value.push(value[i]);\n                        this.index.push(i);\n                        if (this.view.value.length === this.n)\n                            break;\n                    }\n                }\n            }\n            else {\n                for (const i in value) {\n                    if (value[i] !== undefined) {\n                        this.view.value.push(value[i]);\n                        this.index.push(i);\n                        if (this.view.value.length === this.n)\n                            break;\n                    }\n                }\n            }\n        }\n        this.last = this.index.at(-1);\n        this.view.XU0(this.view.value);\n    }\n}\n// class LimitValue extends Operator {\n//   constructor(p, n) {\n//     super()\n//     this.p = p\n//     this.n = n\n//     this.XU0(this.p.value)\n//   }\n//   XR0(){ this.XU0(this.p.value) }\n//   BU1(U1){ \n//     // console.log('U1', { index: this.index, last: this.last, U1, value: this.view.value })\n//     const NU1 = []\n//     for (let i = 0; i < U1.length; i++) {\n//       const name = +U1[i++]\n//       if (name <= this.last) {\n//         const value = U1[i]\n//         const index = find(this.index, name)\n//         this.view.value[index] = value\n//         NU1.push(index, value)\n//       }\n//     } \n//     this.view.BU1(NU1)\n//   }\n//   BI0(I0){ \n//     // console.log('I0', { index: this.index, last: this.last, I0 })\n//     // return\n//     // let last = this.index.at(-1)\n//     const NI0 = []\n//     const NR1 = []\n//     for (let i = 0; i < I0.length; i++) {\n//       const at = +I0[i++]\n//       if (at < this.last || this.view.value.length < this.n) {\n//         // console.og\n//         const value = I0[i]\n//         const index = find(this.index, at)\n//         this.view.value.splice(index, 0, value)\n//         this.index.splice(index, 0, at)\n//         NI0.push(index, value)\n//         this.last = this.index.at(-1)\n//       } else break\n//     }\n//     while (this.view.value.length > this.n) {\n//       // console.log('popping', { value: this.view.value })\n//       this.index.pop()\n//       NR1.push(this.index.length, this.view.value.pop())\n//     }\n//     this.view.BI0(NI0)\n//     this.view.BR1(NR1)\n//     // } else {\n//     //   this.XU0(this.p.value)  // TODO: optimise fast path for all combinations\n//     // }\n//   }\n//   BR1(R1){\n//     // console.log({ index: this.index, last: this.last, R1 })\n//     // return\n//     const NR1 = []\n//     const NI0 = []\n//     for (let i = 0; i < R1.length; i+=2) {\n//       const name = +R1[i]\n//       if (name <= this.last) {\n//         const index = find(this.index, name) \n//         this.index.splice(index, 1)\n//         NR1.push(index, this.view.value.splice(index, 1)[0])\n//         this.last = this.index.at(-1)\n//       } else break\n//     }\n//     if (this.view.value.length < this.n) {\n//       const value = this.p.value\n//       if (isArray(value)) {\n//         for (let i = this.last ?? 0; i < value.length; i++) {\n//           if (value[i] !== undefined) {\n//             NI0.push(this.index.length, value[i])\n//             this.view.value.push(value[i])\n//             this.index.push(i)\n//             if (this.view.value.length === this.n) break\n//           }\n//         }\n//       } else {\n//         if (this.last === undefined) {\n//           for (const i in value) {\n//             if (value[i] !== undefined) {\n//               NI0.push(this.index.length, value[i])\n//               this.view.value.push(value[i])\n//               this.index.push(+i)\n//               if (this.view.value.length === this.n) break\n//             }\n//           }\n//         } else {\n//           for (const i in value) {\n//             if (value[i] !== undefined && i > this.last) {\n//               NI0.push(this.index.length, value[i])\n//               this.view.value.push(value[i])\n//               this.index.push(+i)\n//               if (this.view.value.length === this.n) break\n//             }\n//           }\n//         }\n//       }\n//       this.last = this.index.at(-1)\n//     }\n//     this.view.BR1(NR1)\n//     this.view.BI0(NI0)\n//   }\n//   BR2(){ this.XU0(this.p.value) }\n//   BU2(){ this.XU0(this.p.value) }\n//   BI2(){ this.XU0(this.p.value) }\n//   XU0(value) {\n//     this.view.value = []\n//     this.index = []\n//     if (typeof value === 'object') {\n//       if (isArray(value)) {\n//         let i = -1 \n//         while (i < value.length) {\n//           if (value[++i] !== undefined) {\n//             this.view.value.push(value[i])\n//             this.index.push(i)\n//             if (this.view.value.length === this.n) break\n//           }\n//         }\n//       } else {\n//         for (const i in value) {\n//           if (value[i] !== undefined) {\n//             this.view.value.push(value[i])\n//             this.index.push(+i)\n//             if (this.view.value.length === this.n) break\n//           }\n//         }\n//       }\n//     }\n//     this.last = this.index.at(-1)\n//     this.view.XU0(this.view.value)\n//   }\n// }\nclass ToValue extends Operator {\n    constructor(p, fn) {\n        super();\n        this.p = p;\n        this.fn = fn;\n        this.XU0(this.p.value);\n    }\n    XU0(value) {\n        const new_value = this.fn(value, this.view.value);\n        if (new_value === this.view.value)\n            return;\n        this.view.XU0(this.view.value = new_value);\n    }\n    XR0() { this.XU0(this.p.value); }\n    BR1() { this.XU0(this.p.value); }\n    BU1() { this.XU0(this.p.value); }\n    BI0() { this.XU0(this.p.value); }\n    BR2() { this.XU0(this.p.value); }\n    BU2() { this.XU0(this.p.value); }\n    BI2() { this.XU0(this.p.value); }\n}\nclass DebounceValue extends Operator {\n    constructor(p, fn, ms = 1000) {\n        super();\n        this.p = p;\n        this.fn = fn;\n        this.ms = ms;\n        this.bulk();\n    }\n    calc = () => {\n        delete this.pending;\n        const value = this.fn(this.p.value, this.view.value);\n        if (value === this.view.value)\n            return;\n        const o = [];\n        super.U0({ value }, o);\n        this.view.bulk(o);\n    };\n    bulk() {\n        if (this.pending)\n            return; //clearTimeout(this.pending)\n        this.pending = setTimeout(this.calc, this.ms);\n    }\n}\nclass RowOperator extends Operator {\n    process() { throw new Error('not implemented, process:', this.name); }\n    loop(C, inc, inner) {\n        const NU1 = [], NI0 = [], NR1 = [];\n        for (let i = 0; i < C.length; i += inc) {\n            const name = inner ? C[i][0] : C[i];\n            const old_val = this.view.value?.[name];\n            // console.log('loop', { name, vv: this.view.value })\n            const now_val = this.process(this.p.value[name], name, old_val);\n            const old = old_val !== undefined;\n            const now = now_val !== undefined;\n            if (old && now) {\n                NU1.push(name, now_val);\n                this.view.value[name] = now_val;\n            }\n            else if (!old && now) {\n                NI0.push(name, now_val);\n                this.view.value[name] = now_val;\n            }\n            else if (old && !now) {\n                NR1.push(name, old_val);\n                delete this.view.value[name];\n            }\n        }\n        this.view.BU1(NU1);\n        this.view.BI0(NI0);\n        this.view.BR1(NR1);\n    }\n    XU0(value) {\n        if (typeof value !== 'object')\n            return this.view.XU0(this.view.value = undefined);\n        const n = isArray(value) ? [] : {};\n        for (const i in value) {\n            const v = this.process(value[i], i, this.view.value?.[i]);\n            if (v !== undefined)\n                n[i] = v;\n        }\n        this.view.XU0(this.view.value = n);\n    }\n    BU1(U1) { this.loop(U1, 2, false); }\n    BU2(U2) { this.loop(U2, 2, true); }\n    BI0(I0) { this.loop(I0, 2, false); }\n    BI2(I2) { this.loop(I2, 3, true); }\n    BR2(R2) { this.loop(R2, 2, true); }\n    XR0() { super.XR0(); }\n    BR1(R1) {\n        const NR1 = [];\n        for (let i = 0; i < R1.length; i++) {\n            const name = R1[i++];\n            const value = this.view.value?.[name];\n            if (value !== undefined) {\n                delete this.view.value[name];\n                NR1.push(name, value);\n            }\n        }\n        this.view.BR1(NR1);\n    }\n}\nclass FilterValue extends RowOperator {\n    constructor(p, fn) {\n        super();\n        this.p = p;\n        this.n = 0;\n        this.all = 0;\n        this.fn = fn;\n        this.XU0(this.p.value);\n    }\n    process(value, name, old_val) {\n        return this.fn(value, name, old_val) ? value : undefined;\n    }\n}\nfunction get(k, r) {\n    const p = k.concat([]);\n    while (p.length)\n        r = r?.[p.shift()];\n    return r;\n}\nfunction otof(k, v, fns) {\n    if (typeof v !== 'object')\n        fns.push((r, i) => get(k, r) === v);\n    else\n        for (const i in v) {\n            otof(k.concat(i), v[i], fns);\n        }\n    return fns;\n}\nfunction match(actual, expected) {\n    if (typeof expected !== 'object')\n        return actual === expected;\n    else\n        return Object\n            .entries(expected)\n            .every(([k, v]) => match(actual?.[k], v));\n}\nclass FilterObjectValue extends FilterValue {\n    constructor(p, obj) {\n        super(p, r => match(r, obj));\n    }\n}\nclass FilterStringValue extends FilterValue {\n    constructor(p, name, value) {\n        super(p, value === undefined\n            ? r => !!r[name]\n            : r => r[name] === value);\n    }\n}\nclass FilterColumnValue extends FilterValue {\n    constructor(p, name, value) {\n        const key = [].concat(name);\n        super(p, value === undefined\n            ? r => !!get(key, r)\n            : r => get(key, r) === value);\n    }\n}\nclass MapValue extends RowOperator {\n    constructor(p, fn) {\n        super();\n        this.p = p;\n        this.fn = fn;\n        this.XU0(this.p.value);\n    }\n    process(value, name, old_val) {\n        // console.log({ name, value, old_val })\n        return this.fn(value, name, old_val);\n    }\n}\nclass GroupValue extends Value {\n    constructor(p, fn) {\n        super();\n        this.p = p;\n        this.fn = fn;\n        this.XU0(this.p.value);\n    }\n    static ArrayMapping = class {\n        map = [];\n        insert(k, v) { this.map.splice(k, 0, v); }\n        update(k, v) { this.map[k] = v; }\n        remove(k) { this.map.splice(k, 1); }\n        get(k) { return this.map[k]; }\n    };\n    static ObjectMapping = class {\n        map = new Map;\n        insert(k, v) { this.map.set(k, v); }\n        update(k, v) { this.map.set(k, v); }\n        remove(k) { this.map.delete(k); }\n        get(k) { return this.map.get(k); }\n    };\n    XR0() {\n        this.mapping = undefined;\n        // this.mapping.clear()\n        this.view.XU0(this.view.value = {});\n    }\n    XU0(value) {\n        this.mapping = isArray(value) ? new GroupValue.ArrayMapping : new GroupValue.ObjectMapping; // new Map\n        const new_value = {};\n        iter(value, (i, v) => {\n            const g = this.fn(v);\n            this.mapping.update(i, g);\n            new_value[g] ??= {};\n            new_value[g][i] = v;\n        });\n        this.view.XU0(this.view.value = new_value);\n    }\n    BR1(R1) {\n        const NR1 = [];\n        const NR2 = [];\n        for (let i = 0; i < R1.length; i++) {\n            const name = R1[i++];\n            const group = this.mapping.get(name);\n            if (group === undefined) {\n                throw new Error('unexpected group r1: ' + name + ' ' + typeof name);\n            }\n            this.mapping.remove(name);\n            const value = this.view.value[group][name];\n            // console.log({ name, group, mapping: this.mapping, value: this.view.value })\n            if (value !== undefined) {\n                delete this.view.value[group][name];\n                NR2.push([group, name], value);\n                if (isEmpty(this.view.value[group])) {\n                    NR1.push(group, this.view.value[group]);\n                    delete this.view.value[group];\n                }\n            }\n        }\n        this.view.BR1(NR1);\n        this.view.BR2(NR2);\n    }\n    BU1(U1) {\n        const NR2 = [];\n        const NU2 = [];\n        const NR1 = [];\n        const NI2 = [];\n        const removed_groups = [];\n        for (let i = 0; i < U1.length; i++) {\n            const name = U1[i++];\n            const value = U1[i];\n            const old_group = this.mapping.get(name);\n            const new_group = this.fn(value);\n            if (old_group === new_group) {\n                NU2.push([new_group, name], this.view.value[new_group][name] = value);\n            }\n            else {\n                if (old_group !== undefined) {\n                    const old_value = this.view.value[old_group][name];\n                    delete this.view.value[old_group][name];\n                    NR2.push([old_group, name], old_value);\n                    removed_groups.push(old_group);\n                }\n                this.view.value[new_group] ??= {};\n                NI2.push([new_group], this.view.value[new_group][name] = value, name);\n                this.mapping.update(name, new_group);\n            }\n        }\n        for (const group of removed_groups) {\n            if (isEmpty(this.view.value[group])) {\n                NR1.push(group, this.view.value[group]);\n                delete this.view.value[group];\n            }\n        }\n        if (NR1.length)\n            this.view.BR1(NR1);\n        if (NR2.length)\n            this.view.BR2(NR2);\n        if (NU2.length)\n            this.view.BU2(NU2);\n        if (NI2.length)\n            this.view.BI2(NI2);\n    }\n    BI0(I0) {\n        const NI2 = [];\n        for (let i = 0; i < I0.length; i++) {\n            const name = I0[i++];\n            const value = I0[i];\n            const new_group = this.fn(value);\n            this.view.value[new_group] ??= {};\n            NI2.push([new_group], this.view.value[new_group][name] = value, name);\n            this.mapping.insert(name, new_group);\n        }\n        if (NI2.length)\n            this.view.BI2(NI2);\n    }\n    BR2() { }\n    BU2() { }\n    BI2() { }\n}\nclass LengthFnValue extends Operator {\n    constructor(p, fn) {\n        super();\n        this.p = p;\n        this.fn = fn;\n        this.XU0(this.p.value);\n    }\n    XR0() {\n        this.mapping = {};\n        this.view.XU0(this.view.value = {});\n    }\n    XU0(value) {\n        const new_value = {};\n        this.mapping = {};\n        iter(value, (i, v) => {\n            if (v === undefined)\n                return; // TODO: check undef can always be removed\n            (this.mapping[i] = new_value[this.fn(v)] ??= { value: 0 }).value++;\n        });\n        this.view.XU0(this.view.value = new_value);\n    }\n    check(o) {\n        // this.view.XU0(this.view.value)\n        // const NU1 = []\n        // iter(o, (i, v) => NU1.push(i, this.view.value[i] = v))\n        // if (NU1.length) this.view.BU1(NU1)\n    }\n    BR1(R1) {\n        const updated = {};\n        const { mapping } = this;\n        for (let i = 0; i < R1.length; i++) {\n            const n = R1[i++];\n            const m = mapping[n];\n            if (!m)\n                continue;\n            m.value--;\n            mapping[n] = undefined;\n        }\n        this.view.XU0(this.view.value);\n        // this.check(updated)\n    }\n    BU1(U1) {\n        const { mapping, view, fn } = this;\n        for (let i = 0; i < U1.length; i++) {\n            const n = U1[i++];\n            const v = U1[i];\n            const og = mapping[n];\n            const ng = view.value[fn(v)] ??= { value: 0 };\n            if (og !== ng) {\n                mapping[n] = ng;\n                if (og)\n                    og.value--;\n                ng.value++;\n            }\n        }\n        this.view.XU0(this.view.value);\n        // this.check(updated)\n    }\n    BI0(I0) {\n        // console.log({ I0 })\n        const { mapping, view, fn } = this;\n        for (let i = 0; i < I0.length; i++) {\n            const n = I0[i++];\n            const v = I0[i];\n            if (v === undefined)\n                continue;\n            (mapping[n] = view.value[fn(v)] ??= { value: 0 }).value++;\n        }\n        this.view.XU0(this.view.value);\n        // this.BU1(I0) \n    }\n    BR2() { }\n    BU2() { }\n    BI2() { }\n}\nclass LengthValue extends Operator {\n    constructor(p, fn) {\n        super();\n        this.p = p;\n        // this.keys = new Map\n        this.view.value = 0;\n        this.XU0(p.value);\n    }\n    XR0() {\n        // this.keys.clear()\n        // super.XU0(this.keys.size)\n        this.view.XU0(this.view.value = 0);\n    }\n    XU0(value) {\n        // this.keys.clear()\n        // iter(value, name => this.keys.set(''+name, 1))\n        this.view.value = 0;\n        if (isArray(value)) {\n            this.view.XU0(this.view.value = value.length);\n        }\n        else {\n            iter(value, () => this.view.value++);\n            this.view.XU0(this.view.value);\n        }\n    }\n    BR1(R1) {\n        // iter2(R1, name => this.keys.delete(''+name))\n        this.view.XU0(this.view.value -= R1.length / 2);\n    }\n    BU1(U1) {\n        // console.log('U1.length :>> ', U1.length); \n        // iter2(U1, name => this.keys.set(''+name, 1))\n        // this.view.XU0(this.keys.size)\n    }\n    BI0(I0) {\n        this.view.XU0(this.view.value += I0.length / 2);\n    }\n    BR2() { }\n    BU2() { }\n    BI2() { }\n}\nclass IntersectValue extends Operator {\n    constructor(p, ...sources) {\n        super();\n        this.vp = sources[0];\n        this.p = p;\n        this.sources = new Map([[p, { one: 1, off: ~1 }]]);\n        this.all = 1;\n        for (const src of sources) {\n            const one = 1 << this.sources.size;\n            src.connect(this);\n            this.sources.set(src[Symbols.view], { one, off: ~one });\n            this.all |= one;\n        }\n        if (typeof p.value !== 'object') {\n            super.XU0();\n            return;\n        }\n        const new_value = isArray(this.p.value) ? [] : {};\n        this.filters = isArray(this.p.value) ? [] : {};\n        iter(p.value, (i, v) => {\n            for (const [res, src] of this.sources) {\n                if (i in res.value)\n                    this.filters[i] |= src.one;\n            }\n            if (this.filters[i] === this.all)\n                new_value[i] = v;\n        });\n        this.view.XU0(this.view.value = new_value);\n    }\n    XR0(_, view) {\n        const { off } = this.sources.get(view);\n        iter(this.filters, i => this.filters[i] &= off);\n        this.view.XU0(this.view.value = isArray(this.view.value) ? [] : {});\n    }\n    XU0(value, view) {\n        const { one, off } = this.sources.get(view);\n        this.view.value ??= isArray(this.p.value) ? [] : {};\n        if (typeof value !== 'object')\n            return super.XU0(C); // TODO: reset filters\n        this.filters ??= isArray(this.p.value) ? [] : {};\n        const new_value = isArray(this.p.value) ? [] : {};\n        // iter(this.view.value, (i, v) => {\n        //   if (v === undefined) return \n        //   this.filters[i] &= off\n        // }) \n        iter(this.filters, (i, v) => this.filters[i] = v & off);\n        iter(value, i => {\n            if ((this.filters[i] |= one) === this.all)\n                new_value[i] = this.p.value[i];\n        });\n        this.view.XU0(this.view.value = new_value);\n    }\n    BR1(R1, view) {\n        const { off } = this.sources.get(view);\n        const NR1 = [];\n        const zero = this.all & off;\n        this.view.value ??= isArray(this.p.value) ? [] : {};\n        for (let i = 0; i < R1.length; i += 2) {\n            const name = R1[i];\n            // const cur = this.filters[name] = old & off\n            if ((this.filters[name] & off) === zero) {\n                NR1.push(name, this.view.value[name]);\n                this.view.value[name] = undefined;\n            }\n        }\n        this.view.BR1(NR1);\n    }\n    BU1(U1) {\n        const { all, filters } = this;\n        const NU1 = [];\n        for (let i = 0; i < U1.length; i++) {\n            const name = U1[i++];\n            if (filters[name] === all) {\n                const value = this.p.value[name];\n                if (value === this.view.value[name])\n                    continue;\n                this.view.value[name] = value;\n                NU1.push(name, value);\n            }\n        }\n        this.view.BU1(NU1);\n    }\n    BI0(I0, view) {\n        const { all, sources, filters } = this;\n        const { one } = sources.get(view);\n        const me = this.view.value ??= isArray(this.p.value) ? [] : {};\n        const NI0 = [];\n        for (let i = 0; i < I0.length; i++) {\n            const name = I0[i++];\n            if ((filters[name] |= one) === all) {\n                NI0.push(name, me[name] = this.p.value[name]);\n            }\n        }\n        this.view.BI0(NI0);\n    }\n    R2() { }\n    U2() { }\n    I2() { }\n}\nconst Operators = {\n    filter: (a, b) => typeof a === 'function' ? FilterValue\n        : typeof a === 'string' ? FilterStringValue\n            : isArray(a) ? FilterColumnValue\n                : isObject(a) ? FilterObjectValue\n                    : 'unexpected filter args',\n    between: () => BetweenValue,\n    to: () => ToValue,\n    debounce: () => DebounceValue,\n    map: () => MapValue,\n    length: (fn) => typeof fn === 'function'\n        ? LengthFnValue\n        : LengthValue,\n    intersect: () => IntersectValue,\n    group: () => GroupValue,\n    za: (a, b) => typeof a === 'string' ? ZAColumnValue\n        : typeof a === 'number' ? ZANumberValue\n            : 0,\n    top: () => ZANumberValue,\n    limit: () => LimitValue\n};\nfunction create(views, name, res) {\n    views.set(name, new WeakRef(res));\n    return res;\n}\nfunction connect(p, a, b) {\n    // console.log(\"p, a, b\", p, a, b)\n    if (isArray(a)) {\n        const sink = new ArrSink(p, a);\n        // p.sinks.push(new WeakRef(sink))\n        p.sinks.add(new WeakRef(sink));\n        // console.log(\"connect\", p)\n        return a;\n    }\n    if (typeof a === 'object' && typeof b === 'string') {\n        const sink = new PropSink(p, a, b);\n        // p.sinks.push(new WeakRef(sink))\n        p.sinks.add(new WeakRef(sink));\n        return a;\n    }\n    if (typeof a === 'object' && typeof b === 'function') {\n        const sink = new FunctionSink(p, a, b);\n        // p.sinks.push(new WeakRef(sink))\n        p.sinks.add(new WeakRef(sink));\n        return a;\n    }\n    // p.sinks.push(new WeakRef(a))\n    p.sinks.add(new WeakRef(a));\n    return a;\n}\n// utils\nconst left = prop => function bisect(a, v, lo = 0, hi = a.length) {\n    while (lo < hi) {\n        const mid = lo + hi >>> 1;\n        if (prop(a[mid]) < v)\n            lo = mid + 1;\n        else\n            hi = mid;\n    }\n    return lo;\n};\nfunction bisect_right(v, lo = 0, hi = this.sorted.length) {\n    while (lo < hi) {\n        const mid = lo + hi >>> 1;\n        if (this.col(this.p.value[this.sorted[mid]]) < v)\n            hi = mid;\n        else\n            lo = mid + 1;\n    }\n    return lo;\n}\nfunction find(a, v, lo = 0, hi = a.length) {\n    while (lo < hi) {\n        const mid = lo + hi >>> 1;\n        if (a[mid] < v)\n            lo = mid + 1;\n        else\n            hi = mid;\n    }\n    return lo;\n}\nfunction isEmpty(obj) {\n    for (const i in obj)\n        return false;\n    return true;\n}\n","// @ts-nocheck\nimport { view } from \"./data.js\";\nimport { iter, isArray, noop } from \"./utils.js\";\nconst NS = 'http://www.w3.org/2000/svg';\nconst NODE = Symbol('Node');\nconst { keys } = Object;\nexport const render = (p, np) => Node.render(p, np[NODE]);\nclass DOMSink {\n    constructor(parent, node) {\n        this.parent = parent;\n        this.node = node;\n        this.p = node.data[view];\n        node.data.connect(this);\n        this.XU0(this.p.value);\n    }\n    create_node(k) {\n        const node = this.node.generate(k, k === NODE ? this.node.data : this.node.data[k]);\n        if (isArray(this.nodes)) {\n            const dom = node.create(this.parent, this.nodes[k + 1]);\n            this.nodes.splice(k, 0, dom);\n        }\n        else {\n            this.nodes[k] = node.create(this.parent);\n        }\n    }\n    remove_node(k) {\n        if (isArray(this.nodes)) {\n            this.nodes.pop().remove();\n        }\n        else {\n            this.nodes[k].remove();\n            delete this.nodes[k];\n        }\n    }\n    XR0() {\n        // console.log('DR0 :>> ', { this: this })\n        for (const i in this.nodes)\n            this.remove_node(i);\n    }\n    XU0(value) {\n        // console.log('DU0 :>> ', { this: this, value })\n        if (!this.parent.parentNode) {\n            return;\n        } // TODO: teardown?\n        const prev_nodes = this.nodes ?? {};\n        if (typeof value === 'undefined') {\n            this.nodes = {};\n            for (const i in prev_nodes)\n                this.remove_node(i);\n            return;\n        }\n        if (typeof value !== 'object') {\n            this.nodes = {};\n            for (const i in prev_nodes)\n                this.remove_node(i);\n            this.create_node(NODE);\n            return;\n        }\n        this.nodes ??= isArray(value) ? [] : {};\n        for (const i in value)\n            if (!prev_nodes[i])\n                this.create_node(i); // if (this.nodes[k]) maybe reorder\n        for (const i in prev_nodes)\n            if (!(i in value))\n                this.remove_node(i);\n    }\n    BR1(R1) {\n        // console.log('DR1 :>> ', { this: this, R1 })\n        for (let i = 0; i < R1.length; i++)\n            this.remove_node(R1[i++]);\n    }\n    BU1(U1) {\n        // console.log('DU1 :>> ', { this: this, U1 })\n        for (let i = 0; i < U1.length; i++) {\n            const name = U1[i++];\n            const value = U1[i];\n            if (!this.nodes[name])\n                this.create_node(name /*, value*/);\n        }\n    }\n    BI0(I0) {\n        // console.log('DI0 :>> ', { this: this, I0 })\n        for (let i = 0; i < I0.length; i++) {\n            const name = I0[i++];\n            const value = I0[i];\n            // if (!this.nodes[name]) \n            this.create_node(name /*, value */);\n        }\n        // if (isArray(this.p.value)) // TODO: why only arr?\n        // this.create_node(name, value)  \n    }\n    BR2(BR2) {\n        // console.log('DR2 :>> ', { this: this, BR2 })\n    }\n    BU2(U2) {\n        // console.log('DU2 :>> ', { this: this, U2  })\n        for (let i = 0; i < U2.length; i++) {\n            const [name] = U2[i++];\n            const value = U2[i];\n            // console.log({ name, value })\n            if (!this.nodes[name])\n                this.create_node(name /*, value*/);\n        }\n        // console.log('DU2 :>> ', { this: this, args })\n        // if (!this.nodes[name])\n        //   this.create_node(name, this.p.value[name]) \n    }\n    BI2(I2) {\n        // console.log('DI2 :>> ', { this: this, I2 })\n        // console.log(\"dom I2\", name)\n        // console.log('DI0 :>> ', { this: this, I2 })\n        for (let i = 0; i < I2.length; i += 3) {\n            const [name] = I2[i];\n            if (!this.nodes[name])\n                this.create_node(name /*, value */);\n        }\n    }\n}\n// true - [true]\n// false - [false]\n// undefined - [undefined]\n// null - [null]\n// '0 - [0]\n// '1 - [1]\nclass Child {\n}\nclass Node extends Child {\n    constructor(tag, ns, children = []) {\n        super();\n        this.ns = ns;\n        this.tag = tag.replaceAll('_', '-');\n        this.children = children;\n    }\n    static render(dom, node) {\n        for (const child of node.children) {\n            if (child.data) {\n                dom.sink = new DOMSink(dom, child);\n            }\n            else {\n                child.create(dom);\n            }\n        }\n        return dom;\n    }\n    get new() {\n        const node = new Node(this.tag, this.ns, this.children.concat([]));\n        node.static = this.static;\n        node.data = this.data;\n        node.fn = this.fn;\n        return node;\n    }\n    get hasdata() {\n        return this.data !== undefined || this.static !== undefined;\n    }\n    static add(node, ...args) {\n        // console.log({ args })\n        for (const arg of args) {\n            if (typeof arg === 'string' || typeof arg === 'number' || arg === true) {\n                // Text.add(node, arg)\n                node.static = [arg];\n            }\n            else if (arg instanceof NodeProxy) {\n                const child = arg[NODE];\n                if (child.static) {\n                    iter(child.static, (k, v) => node.children.push(child.generate(k, v)));\n                }\n                else if (child.fn && !child.hasdata) {\n                    node.children.push(child.generate());\n                }\n                else\n                    node.children.push(arg[NODE]);\n            }\n            else if (typeof arg === 'undefined' || arg === false) {\n                node.static = [];\n            }\n            else if (arg[view]) {\n                node.data = arg;\n            }\n            else if (typeof arg === 'function') {\n                const fn1 = node.fn;\n                node.fn = fn1 ? (n, ...args) => arg(fn1(n, ...args), ...args) : arg;\n            }\n            else if (typeof arg === 'object') {\n                node.static = arg;\n            }\n            else {\n                throw new Error('unexpted arg', arg);\n            }\n        }\n        return new NodeProxy(node);\n    }\n    create(parent, before) {\n        const dom = this.ns\n            ? document.createElementNS(NS, this.tag)\n            : document.createElement(this.tag);\n        before\n            ? parent.insertBefore(dom, before)\n            : parent.append(dom);\n        return Node.render(dom, this);\n    }\n    generate(k, v) {\n        let node = new Node(this.tag, this.ns, this.children.concat([]));\n        const content = this.fn\n            ? this.fn(new NodeProxy(node), v, k)\n            : v;\n        // console.log('generate', {v, k, node, fn: this.fn, content })\n        if (content instanceof NodeProxy) {\n            // console.log('******************************************')      \n            node = content[NODE];\n            // node = Node.add(node, content)[NODE]\n            // console.log('******************************************')      \n            // node = content[NODE]\n        }\n        else {\n            Text.add(node, content);\n        }\n        return node;\n    }\n}\nclass Prop extends Child {\n    constructor(name, value) {\n        super();\n        this.name = name;\n        this.value = value;\n    }\n    static add(node, n, v) {\n        if (arguments.length == 2)\n            v = true;\n        typeof n === 'object'\n            ? node.children.push(...keys(n).map(k => new this(k, n[k])))\n            : node.children.push(new this(n, v));\n        return new NodeProxy(node);\n    }\n    create(parent) {\n        this.parent = parent;\n        if (this.value?.[view]) {\n            parent.nrefs ??= {};\n            parent.nrefs[this.name] = this.value.connect(this, 'set');\n        }\n        else if (this.name?.[view]) {\n            parent.arefs ??= [];\n            parent.arefs.push(this.name.connect(this, 'set'));\n        }\n        else\n            this.set = this.value;\n    }\n    set set(value) {\n        value === false || value === undefined\n            ? this.remove()\n            : this.add(value);\n    }\n}\nclass Attr extends Prop {\n    add(value) { this.parent.setAttribute(this.name, value); }\n    remove() { this.parent.removeAttribute(this.name); }\n}\nclass Class extends Prop {\n    add() { this.parent.classList.add(this.name); }\n    remove() { this.parent.classList.remove(this.name); }\n}\nclass ID extends Prop {\n    add() { this.parent.id = this.name; }\n    remove() { this.parent.removeAttribute('id'); }\n}\nclass Style extends Prop {\n    add(value) { this.parent.style.setProperty(this.name, value); }\n    remove() { this.parent.style.removeProperty(this.name); }\n}\nclass Text extends Prop {\n    create(parent) {\n        parent.appendChild(this.dom = document.createTextNode(''));\n        super.create(parent);\n    }\n    add() { this.dom.textContent = this.name; }\n    remove() { this.dom.textContent = ''; }\n}\nclass Event extends Prop {\n    create(parent) {\n        parent.addEventListener(this.name.toLowerCase(), this.value);\n    }\n}\nconst props = {\n    attr: Attr,\n    class: Class,\n    on: Event,\n    style: Style,\n    id: ID,\n    text: Text,\n    nodes: Node,\n};\nclass NodeProxy {\n    constructor(node, prop) {\n        this.node = node;\n        this.prop = prop;\n        return new Proxy(noop, this);\n    }\n    set() { throw 'cannot set properties'; }\n    deleteProperty() { throw 'cannot delete properties'; }\n    get(t, name) {\n        const n = this.node;\n        if (name === NODE)\n            return n;\n        else if (typeof name === 'symbol')\n            return;\n        else if (name in props)\n            return new NodeProxy(n, name);\n        else if (name.startsWith('#'))\n            return ID.add(n.new, name.slice(1), true);\n        else if (name.startsWith('.'))\n            return Class.add(n.new, name.slice(1), true);\n        else if (name.includes('='))\n            return Attr.add(n.new, ...name.split('='));\n        else\n            return Class.add(n.new, name.replaceAll('_', '-'), true);\n    }\n    apply(t, m, args) {\n        return props[this.prop ?? 'nodes'].add(this.node.new, ...args);\n    }\n    getPrototypeOf(targer) {\n        return NodeProxy.prototype;\n    }\n}\nexport const HTML = new Proxy({}, {\n    get(t, name) { return new NodeProxy(new Node(name)); },\n});\nexport const SVG = new Proxy({}, {\n    get(t, name) { return new NodeProxy(new Node(name, true)); },\n});\n"],"names":["iter","o","fn","isArray","i","length","Array","noop","value","Symbol","$","v","ViewProxy","View","view","Symbols","random","crypto","randomUUID","sclone","d","undefined","structuredClone","Value","constructor","this","update","key","Error","XU0","BU1","BU2","insert","at","BI0","BI2","remove","XR0","BR1","BR2","BR1A","R1","NR1","_this$view$value","name","splice","push","_this$view$value2","R2","NR2","loop1","last","path","slice","reverse","vo","n","pop","U1","NU1","NI0","_this$view$value3","_this$view$value4","U2","I0","BI0A","_i","_I0$_i","_this$view$value5","I2","_i2","_i3","_I2$_i2","_I2$_i","Operator","res","sinks","Set","views","Map","child","p","_p$value","LinkedView","each","sink","size","offset","Infinity","V1","_this$get_named","get_named","x","deref","delete","_this$get_named2","_this$get_named3","rest","_this$p$value","_this$value","_this$p$value2","_this$get_named4","_this$p$value3","_this$get_named5","_this$get_named6","_this$p$value4","_this$get_named7","_this$p$value5","_this$get_named8","_this$get_named9","some_sink","ref","get_or_create_named","_this$views$get$deref","_this$views$get","get","set","WeakRef","create","_this$views$get2","disconnect","s","connect","add","Sink","super","src","args","U0","R0","iter2","arr","ArrSink","type","iter3","I1","lifetimes","WeakMap","PropSink","obj","prop","_lifetimes$get","refs","Proxy","deleteProperty","target","t","toPrimitive","hint","_this$view$value6","toString","iterator","reactive","apply","m","_Operators$type","a","b","FunctionSink","Operators","call","matches","getPrototypeOf","targer","prototype","BetweenValue","col","lo","hi","plo","phi","arg","sorted","find","left","extent","hi_val","lo_val","new_lo","new_hi","hi_index","lo_index","ti","tv","new_value","sort","va","vb","ZAValue","col_name","Object","keys","map","oidx","get_index","len","nidx","idx","new_idx","changes","has","id","indexOf","mid","ZAColumnValue","ZANumberValue","LimitValue","index","ToValue","DebounceValue","ms","calc","pending","bulk","setTimeout","RowOperator","process","loop","C","inc","inner","_this$view$value7","old_val","now_val","old","now","_this$view$value8","_this$view$value9","FilterValue","all","k","r","concat","_r","shift","match","actual","expected","entries","every","FilterObjectValue","FilterStringValue","FilterColumnValue","MapValue","GroupValue","mapping","ArrayMapping","ObjectMapping","g","group","isEmpty","NU2","NI2","removed_groups","old_group","new_group","_this$view$value10","old_value","_this$view$value11","LengthFnValue","_this$fn","_new_value$_this$fn","check","_view$value","_fn","_view$value$_fn","og","ng","_view$value2","_fn2","_view$value2$_fn","LengthValue","IntersectValue","sources","vp","one","off","filters","_","_this$view","_this$view2","zero","_this$view3","_this$view3$value","me","filter","between","to","debounce","intersect","za","top","limit","NODE","render","np","Node","DOMSink","parent","node","data","create_node","generate","nodes","dom","remove_node","_this$nodes","parentNode","prev_nodes","Child","tag","ns","children","replaceAll","new","static","hasdata","NodeProxy","fn1","before","document","createElementNS","createElement","insertBefore","append","content","Text","Prop","arguments","_this$name","_parent$nrefs","nrefs","arefs","Attr","setAttribute","removeAttribute","Class","classList","ID","appendChild","createTextNode","textContent","props","attr","class","on","addEventListener","toLowerCase","style","setProperty","removeProperty","text","startsWith","includes","split","_this$prop","HTML","SVG"],"mappings":"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"}